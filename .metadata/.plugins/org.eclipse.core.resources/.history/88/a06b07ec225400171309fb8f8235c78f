<cfdump var="#form#"/>
<!---Input values in the databsse---> 
<cfquery datasource="Project_DataSource" result="rsInterestInfo">
	
	<!---Insert Data in User_Details--->
	INSERT INTO dbo.Users_Details
		(FirstName,LastName,EmailAddress,Password)
		values
		('#form.firstname#','#form.lastname#','#form.user_email#','#form.user_password#')
</cfquery>		
	
<cfquery datasource="Project_DataSource" result="rsUserAddress">

	<!---Insert Data into User_Address--->
	INSERT INTO dbo.User_Address
		(uid,CurrentAddress,PermanentAddress,Country,State,City)
		values
		((select uid from dbo.Users_Details where FirstName = '#form.firstname#' ),'#form.caddress#','#form.paddress#','#form.country#','#form.state#','#form.city#')
</cfquery>

<cfquery datasource="Project_DataSource" result="rsAdditionalInfo">
	<!---Insert Data into User_Additional_Info--->
	INSERT INTO dbo.Users_Additional_Info
		(uid,Gender,subscription)
		values
		((select uid from dbo.Users_Details where FirstName = '#form.firstname#' ),'#form.gender#','#form.subs_value#')
</cfquery>

<cfquery datasource="Project_DataSource" result="rsUsersPhoneNo">
	<!---Insert Data into User_Phone_Number--->
	INSERT INTO dbo.Users_Phone_Number
		(uid,PhoneNumber)
		values
		((select uid from dbo.Users_Details where FirstName = '#form.firstname#' ),'#form.phoneno#')
	<cfif #form.phonenoalt# NEQ "">
		INSERT INTO dbo.Users_Phone_Number
			(uid,PhoneNumber)
		values
			((select uid from dbo.Users_Details where FirstName = '#form.firstname#' ),'#form.phonenoalt#')
		
	</cfif>
</cfquery>

	
<cfloop list="#form.user_interest#" index="interestValue" delimiters=",">
	<cfquery datasource="Project_DataSource" result="rsUserInterest">
		<!---Insert Data into User_Interest--->
		INSERT INTO dbo.Users_Interest
			(uid,InterestID)
			values
			((select uid from dbo.Users_Details where FirstName = '#form.firstname#' ),(select InterestID from dbo.Interest_Info where InterestName = '#interestValue#'))
	</cfquery>
</cfloop>>	